#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int run_exploit() {
    printf("[C Plugin] Triggering buffer overflow payload...\n");

    FILE *f = fopen("vm/payload.txt", "w");
    if (!f) {
        perror("fopen");
        return 0;
    }

    // Generate overflow payload（ 512 'A'）
    fputs("AAA", f);
    for (int i = 0; i < 509; i++) {
        fputc('A', f);
    }

    fclose(f);
    return 1;
}
